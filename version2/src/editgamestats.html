<!DOCTYPE html>

<!-- File Size: 9KB | Load Time: 2.08s -->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="../style/style.css">
	<script src="https://www.gstatic.com/firebasejs/4.7.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyCPC5DTvuqRNQbM4pEa6JpAb4Y1KSptCsI",
      authDomain: "homework2-6c804.firebaseapp.com",
      databaseURL: "https://homework2-6c804.firebaseio.com",
      projectId: "homework2-6c804",
      storageBucket: "homework2-6c804.appspot.com",
      messagingSenderId: "279004110495"
    };
    firebase.initializeApp(config);
    var database = firebase.database();
  </script>
  <title>TeamWatch</title>
</head>

<body>
  <nav class="navbar">
    <a href="./home.html" id="logo">TeamWatch</a>
    <a href="./home.html">Home</a>
    <a href="./gameschedule.html">Game</a>
    <a href="./players.html">Roster</a>
    <a href="./login.html" id="logout" onclick="logoutClean()"> Logout</a>
  </nav>
  <div class="viewgamestatscontainer">
		<h1 class="vgsgameheader" id="myteam"></h1>
		<h1 class="vgsgameheader">vs.</h1>
		<h1 class="vgsgameheader" id="theirteam"></h1>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamscorevgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamscorevgs')">-</button> <span id="myteamscorevgs"></span> <span class="vgsstats">Score</span> <span id="oppteamscoresvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamscoresvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamscoresvgs')">-</button></p>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamfoulvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamfoulvgs')">-</button> <span id="myteamfoulvgs"></span> <span class="vgsstats">Foul</span> <span id="oppteamfoulvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamfoulvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamfoulvgs')">-</button></p>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamredcardvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamredcardvgs')">-</button> <span id="myteamredcardvgs"></span> <span class="vgsstats">Red Card</span> <span id="oppteamredcardvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamredcardvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamredcardvgs')">-</button></p>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamyellowcardvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamyellowcardvgs')">-</button> <span id="myteamyellowcardvgs"></span> <span class="vgsstats">Yellow Card</span> <span id="oppteamyellowcardvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamyellowcardvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamyellowcardvgs')">-</button></p>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamshotsongoalvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamshotsongoalvgs')">-</button> <span id="myteamshotsongoalvgs"></span> <span class="vgsstats">Shots on Goal</span> <span id="oppteamshotsongoalvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamshotsongoalvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamshotsongoalvgs')">-</button></p>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamgoalsvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamgoalsvgs')">-</button> <span id="myteamgoalsvgs"></span> <span class="vgsstats">Goals</span> <span id="oppteamgoalsvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamgoalsvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamgoalsvgs')">-</button></p>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamcornerkicksvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamcornerkicksvgs')">-</button> <span id="myteamcornerkicksvgs"></span> <span class="vgsstats">Corner Kicks</span> <span id="oppteamcornerkicksvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamcornerkicksvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamcornerkicksvgs')">-</button></p>
		<hr class="vgshr">
		<p><button type="button" class="incrgamestats" onclick="incr('myteamgoalkicksvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('myteamgoalkicksvgs')">-</button> <span id="myteamgoalkicksvgs"></span> <span class="vgsstats">Goal Kicks</span> <span id="oppteamgoalkicksvgs"></span> <button type="button" class="incrgamestats" onclick="incr('oppteamgoalkicksvgs')">+</button><button type="button" class="incrgamestats" onclick="decr('oppteamgoalkicksvgs')">-</button></p>
		<p><input type="button"  value="Save" id="egssaveBtn"></p>
  </div>
  <script>

    var teamSpanIdArray = ['myteamscorevgs', 'myteamfoulvgs', 'myteamredcardvgs', 'myteamyellowcardvgs', 'myteamshotsongoalvgs', 'myteamgoalsvgs', 'myteamcornerkicksvgs', 'myteamgoalkicksvgs'];
    var oppSpanIdArray = ['oppteamscoresvgs', 'oppteamfoulvgs', 'oppteamredcardvgs', 'oppteamyellowcardvgs', 'oppteamshotsongoalvgs', 'oppteamgoalsvgs', 'oppteamcornerkicksvgs', 'oppteamgoalkicksvgs'];
    var gam = JSON.parse(localStorage.getItem('gamestattoedit'));
		var game = gam.stats;
    var myTeamStats = [game.mygoals, game.myfouls, game.myredcards, game.myyellowcards, game.myshotsongoal, game.mygoals, game.mycornerkicks, game.mygoalkicks];
    var oppTeamStats = [game.opponentgoals, game.opponentfouls, game.opponentredcards, game.opponentyellowcards, game.opponentshotsongoal, game.opponentgoals, game.opponentcornerkicks, game.opponentgoalkicks];

		var mt = document.getElementById('myteam'); 
		var tt = document.getElementById('theirteam'); 

  	window.addEventListener('DOMContentLoaded', function() {
  	  for (var k = 0; k < teamSpanIdArray.length; k++) {
  	  	var teamCurrStat = document.getElementById(teamSpanIdArray[k]);
  		teamCurrStat.innerHTML = myTeamStats[k];
  		var oppCurrStat = document.getElementById(oppSpanIdArray[k]);
  		oppCurrStat.innerHTML = oppTeamStats[k];
  	  }

			mt.innerHTML = localStorage.getItem('myteamname'); 
			tt.innerHTML = gam.opponentname;

  	});

  	function incr(spanId) {
  	  var currStat = document.getElementById(spanId);
  	  var newNum = Number(currStat.innerHTML) + 1;
  	  currStat.innerHTML = newNum;
  	}

  	function decr(spanId) {
  	  var currStat = document.getElementById(spanId);
  	  var newNum = Number(currStat.innerHTML) - 1;
      if (newNum < 0) {
        newNum = 0;
      }
  	  currStat.innerHTML = newNum;
  	}

		egssaveBtn.addEventListener('click', function() {
			location.href='./viewgamestats.html';
		})

  	egssaveBtn.addEventListener('click', function () {

			var glist = JSON.parse(localStorage.getItem('games')); 
			var ix; 

			for(var g = 0; g < glist.length; g++) {
        var gdate = new Date(glist[g].date); 
        var gadate = new Date(gam.date); 

        if( (glist[g].opponentname == gam.opponentname) 
        && (gdate.setHours(0, 0, 0, 0) == gadate.setHours(0, 0, 0, 0))){
          
					var gm = {}; 

					ix = g; 

					gm.mygoals = myteamscorevgs.innerHTML; 
					gm.opponentgoals = oppteamscoresvgs.innerHTML;
					gm.myfouls = myteamfoulvgs.innerHTML; 
					gm.opponentfouls = oppteamfoulvgs.innerHTML; 
					gm.myredcards = myteamredcardvgs.innerHTML; 
					gm.opponentredcards = oppteamredcardvgs.innerHTML;
					gm.myyellowcards = myteamyellowcardvgs.innerHTML; 
					gm.opponentyellowcards = oppteamyellowcardvgs.innerHTML; 
					gm.myshotsongoal = myteamshotsongoalvgs.innerHTML; 
					gm.opponentshotsongoal = oppteamshotsongoalvgs.innerHTML; 
					gm.mycornerkicks = myteamcornerkicksvgs.innerHTML; 
					gm.opponentcornerkicks = oppteamcornerkicksvgs.innerHTML; 
					gm.mygoalkicks = myteamgoalkicksvgs.innerHTML; 
					gm.opponentgoalkicks = oppteamgoalkicksvgs.innerHTML; 

					glist[g].stats = gm;					
        }
      }

			localStorage.setItem('games', JSON.stringify(glist)); 
			localStorage.setItem('gametoview', JSON.stringify(glist[ix]));
  	});

    function logoutClean() {
			var rrf = firebase.database().ref();
			var cu = rrf.child("currentuser/"); 
			cu.set({
				username: "", 
				team: "", 
				type: ""
			});
    }
  </script>
</body>
</html>
